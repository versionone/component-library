---
name: Publishing
menu: Guides
---

## Types of Versions

A major version is when a incompatible API change is made.

A minor version is when a functionality is added in a backwards-compatible manner.

A patch version is when a backward-compatible bug fix is made.

Version numbers follow the pattern MAJOR.MINOR.PATCH

1. types of versions - major/minor/patch
2. when to publish types -- what is major

## Branching Strategy

There are 2 main branches, `master` and `next`.

`Master` is the current published version. Minor changes such as feature updates and defect fixes should get merged into `master`.

`Next` is the next major version that has not yet been released. Breaking changes should be merged into `next`.

After changes have been made to `master`, `next` should be rebased on `master`.

3. branching strategy
   - 2 main, master and next
     - master: a place for current published version
       - minor changes (feature updates, defect fixes) get merged into master and then into next
     - next: next major version of unreleased stuff
       - breaking changes get merged into next
       - rebase as needed on master

## How to Publish

The library publishes to [npmjs.com](https://www.npmjs.com/package/@versionone/components).
Login is required, either with the VersionOne account or with an existing account that is linked to our org.

> Be sure to Login using `npm login` before attempting to publish

### Publishing Minor and Patch Versions

Feature branches should be merged into `master` before publishing from `master`.
Minor versions and patches can be published using `yarn lerna publish {minor|patch}`.

Use `NODE_ENV=production yarn build` to build the production bundle and production doc sites.

### Publishing Major Versions

4. how to publish
   - where it publishes to: [npmjs.com](https://www.npmjs.com/package/@versionone/components)
   - requires login first - versionone account or existing (how to link to our org)
   - if you want to publish a minor version, command 'yarn lerna publish minor'
     - feature branch -> master -> publish from master (minor/patch)
     - `NODE_ENV=production yarn build`
       - this will build production bundle **and** production docs sites
     - `yarn lerna publish {minor|patch}`
   - if publishing major version
   - next (candidate) => master => publish major
   - `yarn lerna publish major`
   - if introducing a new breaking change
     - feature branch => next => publish canary
     - `yarn lerna publish --canary {premajor}` (verify against resource 1)
   - if introducing another breaking change (not the first introducion)
     - `yarn lerna publish --canary {preminor|prepatch}`
5. how to publish doc site
   - docs sites get published on every PR (see PR details for build site)
   - docs site published on every merge to master and next
   - however, to publish a new "release" of the site (and not a demo/build)
   - Log into [netlify](https://www.netlify.com/) (creds are in skynet)
   - navigate to versionone-components project
   - on project overview, scroll to "Production Deploys"
     - click on desired prodcution build
     - "publish deploy" button
       - this **may** happen automatically when merging to master
       - unsure if it builds a deploy, but requires an explicty "button press" or if it will do it automatically (verify)
6. trouble shooting- common issues

- oops, I published something wrong...how do a delete/backout a publish

7. resources
   - https://github.com/lerna/lerna/tree/master/commands/publish#--canary
   - https://semver.org/

PR process:

- open PR in github
- PR passes all the things
- use github to merge PR
